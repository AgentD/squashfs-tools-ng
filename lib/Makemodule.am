libfstree_a_SOURCES = lib/fstree/fstree.c lib/fstree/fstree_from_file.c
libfstree_a_SOURCES += lib/fstree/fstree_sort.c lib/fstree/fstree_from_dir.c
libfstree_a_SOURCES += lib/fstree/gen_inode_table.c lib/fstree/get_path.c
libfstree_a_SOURCES += lib/fstree/node_stat.c lib/fstree/mknode.c
libfstree_a_SOURCES += lib/fstree/add_by_path.c lib/fstree/xattr.c
libfstree_a_SOURCES += lib/fstree/node_from_path.c include/fstree.h
libfstree_a_SOURCES += lib/fstree/gen_file_list.c lib/fstree/deduplicate.c
libfstree_a_CFLAGS = $(AM_CFLAGS)
libfstree_a_CPPFLAGS = $(AM_CPPFLAGS)

libtar_a_SOURCES = lib/tar/read_header.c lib/tar/write_header.c lib/tar/skip.c
libtar_a_SOURCES += lib/tar/number.c lib/tar/checksum.c lib/tar/cleanup.c
libtar_a_SOURCES += lib/tar/read_sparse_map.c lib/tar/read_sparse_map_old.c
libtar_a_SOURCES += lib/tar/base64.c lib/tar/urldecode.c lib/tar/internal.h
libtar_a_SOURCES += include/tar.h
libtar_a_CFLAGS = $(AM_CFLAGS)
libtar_a_CPPFLAGS = $(AM_CPPFLAGS)

libcompress_a_SOURCES = lib/comp/compressor.c lib/comp/internal.h
libcompress_a_SOURCES += include/compress.h
libcompress_a_CFLAGS = $(AM_CFLAGS)
libcompress_a_CPPFLAGS = $(AM_CPPFLAGS)

libsquashfs_a_SOURCES = include/meta_writer.h include/squashfs.h
libsquashfs_a_SOURCES += lib/sqfs/meta_writer.c lib/sqfs/super.c
libsquashfs_a_SOURCES += lib/sqfs/id_table.c include/id_table.h
libsquashfs_a_SOURCES += lib/sqfs/write_table.c include/highlevel.h
libsquashfs_a_SOURCES += lib/sqfs/read_super.c lib/sqfs/meta_reader.c
libsquashfs_a_SOURCES += include/meta_reader.h lib/sqfs/id_table_write.c
libsquashfs_a_SOURCES += lib/sqfs/id_table_read.c lib/sqfs/read_inode.c
libsquashfs_a_SOURCES += lib/sqfs/readdir.c
libsquashfs_a_SOURCES += lib/sqfs/write_dir.c lib/sqfs/write_inode.c
libsquashfs_a_SOURCES += lib/sqfs/serialize_fstree.c
libsquashfs_a_SOURCES += lib/sqfs/tree_node_from_inode.c
libsquashfs_a_SOURCES += lib/sqfs/deserialize_fstree.c
libsquashfs_a_SOURCES += lib/sqfs/data_writer.c lib/sqfs/write_xattr.c
libsquashfs_a_SOURCES += include/data_writer.h
libsquashfs_a_SOURCES += include/data_reader.h lib/sqfs/data_reader.c
libsquashfs_a_SOURCES += lib/sqfs/write_export_table.c
libsquashfs_a_SOURCES += lib/sqfs/read_table.c lib/sqfs/statistics.c

libutil_a_SOURCES = lib/util/canonicalize_name.c lib/util/write_data.c
libutil_a_SOURCES += lib/util/read_data.c include/util.h
libutil_a_SOURCES += lib/util/print_version.c lib/util/mkdir_p.c
libutil_a_SOURCES += lib/util/str_table.c include/str_table.h
libutil_a_SOURCES += lib/util/dirstack.c lib/util/padd_file.c
libutil_a_SOURCES += lib/util/read_data_at.c lib/util/crc32.c

if WITH_GZIP
libcompress_a_SOURCES += lib/comp/gzip.c

libcompress_a_CFLAGS += $(ZLIB_CFLAGS)
libcompress_a_CPPFLAGS += -DWITH_GZIP
endif

if WITH_XZ
libcompress_a_SOURCES += lib/comp/xz.c

libcompress_a_CFLAGS += $(XZ_CFLAGS)
libcompress_a_CPPFLAGS += -DWITH_XZ
endif

if WITH_LZO
libcompress_a_SOURCES += lib/comp/lzo.c

libcompress_a_CFLAGS += $(LZO_CFLAGS)
libcompress_a_CPPFLAGS += -DWITH_LZO
endif

if WITH_LZ4
libcompress_a_SOURCES += lib/comp/lz4.c

libcompress_a_CFLAGS += $(LZ4_CFLAGS)
libcompress_a_CPPFLAGS += -DWITH_LZ4
endif

if WITH_ZSTD
libcompress_a_SOURCES += lib/comp/zstd.c

libcompress_a_CFLAGS += $(ZSTD_CFLAGS)
libcompress_a_CPPFLAGS += -DWITH_ZSTD
endif

if WITH_SELINUX
libfstree_a_SOURCES += lib/fstree/selinux.c

libfstree_a_CFLAGS += $(LIBSELINUX_CFLAGS)
libfstree_a_CPPFLAGS += -DWITH_SELINUX
endif

noinst_LIBRARIES += libfstree.a libcompress.a libutil.a libsquashfs.a libtar.a
