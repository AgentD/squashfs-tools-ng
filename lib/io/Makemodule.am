libio_a_SOURCES = include/io/dir_iterator.h \
	lib/io/src/dir_tree_iterator.c
libio_a_CFLAGS = $(AM_CFLAGS) $(ZLIB_CFLAGS) $(XZ_CFLAGS)
libio_a_CFLAGS += $(ZSTD_CFLAGS) $(BZIP2_CFLAGS)

noinst_LIBRARIES += libio.a

LIBIO_TESTS = test_dir_iterator \
	test_dir_tree_iterator test_dir_tree_iterator2 test_dir_tree_iterator3

test_dir_iterator_SOURCES = lib/io/test/dir_iterator.c
test_dir_iterator_LDADD = libio.a libsquashfs.la libutil.a libcompat.a
test_dir_iterator_CPPFLAGS = $(AM_CPPFLAGS)
test_dir_iterator_CPPFLAGS += -DTESTPATH=$(top_srcdir)/lib/io/test/testdir

test_dir_tree_iterator_SOURCES = lib/io/test/dir_tree_iterator.c
test_dir_tree_iterator_LDADD = libio.a libsquashfs.la libutil.a libcompat.a
test_dir_tree_iterator_CPPFLAGS = $(AM_CPPFLAGS)
test_dir_tree_iterator_CPPFLAGS += -DTESTPATH=$(top_srcdir)/lib/io/test/testdir

test_dir_tree_iterator2_SOURCES = lib/io/test/dir_tree_iterator2.c
test_dir_tree_iterator2_LDADD = libio.a libsquashfs.la libutil.a libcompat.a
test_dir_tree_iterator2_CPPFLAGS = $(AM_CPPFLAGS)
test_dir_tree_iterator2_CPPFLAGS += -DTESTPATH=$(top_srcdir)/lib/io/test/testdir

test_dir_tree_iterator3_SOURCES = lib/io/test/dir_tree_iterator3.c
test_dir_tree_iterator3_LDADD = libio.a libsquashfs.la libutil.a libcompat.a
test_dir_tree_iterator3_CPPFLAGS = $(AM_CPPFLAGS)
test_dir_tree_iterator3_CPPFLAGS += -DTESTPATH=$(top_srcdir)/lib/io/test/testdir

check_PROGRAMS += $(LIBIO_TESTS)
TESTS += $(LIBIO_TESTS)

EXTRA_DIST += $(top_srcdir)/lib/io/test/testdir
